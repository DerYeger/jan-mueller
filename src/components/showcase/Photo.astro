---
import { Image } from 'astro:assets'
import { cn } from '~/components/ui/cn'

export type Location = `${string}, ${string}`

export interface PhotoData {
  src: Promise<typeof import('*.png')> | Promise<typeof import('*.webp')>
  alt: (location: Location) => string
  location: Location
}

interface Props {
  photo: PhotoData
  index: number
  total: number
  initial?: boolean
}

const { photo, initial = false, index, total } = Astro.props
const { src, alt, location } = photo
---

<div
  class={cn(`photo absolute inset-0 transition-opacity duration-1000 data-[active='true']:z-10 data-[active='false']:opacity-0`)}
  data-active={initial ? 'true' : 'false'}
>
  <Image
    src={src}
    alt={alt(location)}
    height={600}
    quality="high"
    layout="full-width"
    format="webp"
    loading="lazy"
    class="m-0 size-full object-cover"
  />
  <div
    aria-hidden="true"
    class="absolute inset-x-3 bottom-2 transition-opacity opacity-0 group-focus-within:opacity-100 group-hover:opacity-100 duration-500"
  >
    <div class="bg-glass rounded-3xl px-2 py-1 text-center text-xs">
      {location}
    </div>
  </div>
</div>
