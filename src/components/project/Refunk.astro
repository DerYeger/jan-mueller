---
import ProjectDescription from '~/components/project/ProjectDescription.astro'
import ProjectTitle from '~/components/project/ProjectTitle.astro'

const { default: innerHTML } = await import(`~/assets/projects/Refunk.svg?raw`)
---

<div
  class="refunk card card-hover group w-full h-full overflow-hidden relative p-6 z-10"
>
  <div
    class="refunk-logo absolute inset-0 transition-all scale-[2000%] duration-700 dark:brightness-50 dark:!opacity-100"
  >
    <Fragment set:html={innerHTML} />
  </div>
  <div class="prose dark:prose-invert relative">
    <ProjectTitle>Refunk</ProjectTitle>
    <ProjectDescription>
      A Kotlin library for studying primitive recursive functions using a
      mathematical DSL.
    </ProjectDescription>
  </div>
</div>

<script>
  const observer = new IntersectionObserver(
    (entries) => {
      entries.forEach((entry) => {
        if (!entry.isIntersecting) {
          return
        }
        const element = entry.target.getElementsByClassName('refunk-logo')[0]!
        element.classList.toggle('scale-[2000%]')
        element.classList.toggle('scale-75')
        element.classList.toggle('opacity-25')
        observer.unobserve(entry.target)
      })
    },
    { threshold: 0.9 }
  )

  const logos = [...document.getElementsByClassName('refunk')]
  logos.forEach((logo) => observer.observe(logo))
</script>
